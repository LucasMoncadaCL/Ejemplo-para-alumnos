# Ejemplo: Prompt y respuesta — Conversión DDL (Oracle → PostgreSQL)

## Prompt de ejemplo

"Convierte este DDL de Oracle 21c a PostgreSQL 15. Mantén claves primarias, foráneas, índices y defaults. Explica brevemente cada cambio y marca cualquier decisión ambigua que deba revisar manualmente. Devuélvelo en un bloque SQL listo para ejecutar en PostgreSQL."

### DDL (entrada)
```sql
CREATE TABLE tasks (
  id NUMBER(19),
  user_id RAW(16),
  titulo VARCHAR2(255) NOT NULL,
  descripcion CLOB,
  completada NUMBER(1) DEFAULT 0,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT SYSTIMESTAMP,
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT SYSTIMESTAMP,
  CONSTRAINT tasks_pkey PRIMARY KEY (id)
);
```

## Respuesta (ejemplo generado por LLM)

```sql
-- Conversión orientativa a PostgreSQL
CREATE TABLE public.tasks (
  id bigint PRIMARY KEY,
  user_id uuid NOT NULL,
  titulo varchar(255) NOT NULL,
  descripcion text,
  completada boolean NOT NULL DEFAULT false,
  created_at timestamptz NOT NULL DEFAULT now(),
  updated_at timestamptz NOT NULL DEFAULT now()
);

-- Notas:
-- 1) RAW(16) -> uuid: si el RAW contiene UUID binario, convertir previamente al formato textual.
-- 2) NUMBER(1) -> boolean: mapeamos 0->false, 1->true en la etapa de carga si es necesario.
-- 3) CLOB -> text en Postgres.
```

## Qué revisar manualmente
- Validar cómo se almacena el `user_id` en Oracle: si no es UUID, modificar mapping.
- Comprobar secuencias/IDENTITY si `id` debe auto-incrementar (añadir `generated by default as identity` o sequence+default nextval).
- Revisar triggers/procedimientos asociados que gestionen `updated_at`.

---

Guarda este archivo como referencia y adapta el prompt según el fragmento que quieras convertir.

---

## Cómo extraer DDL desde Oracle Data Modeler (pasos y captura sugerida)

Pasos rápidos:

1. Abre tu modelo en Oracle Data Modeler.
2. Menú `File` → `Export` → `DDL File`.
3. En la ventana de exportación selecciona las tablas/objetos que quieras exportar.
4. Elige el dialecto Oracle y guarda como `model.sql`.

Captura sugerida: `data_modeler_export_ddl.png` (muestra el diálogo de exportación y las opciones seleccionadas).

Consejo práctico: si tu DDL incluye secuencias o triggers que generan PKs, incluye también esos objetos en la exportación; el prompt deberá recibirlos para proponer la conversión a `SERIAL`/`IDENTITY` o `uuid`.

## PowerShell (Windows) — ejecutar DDL convertido en PostgreSQL

Si ya tienes el DDL convertido (`converted.sql`) y quieres ejecutarlo en una base PostgreSQL remota o local desde PowerShell, usa un comando `psql` como ejemplo:

```powershell
$pgHost = 'db.example.com'
$pgPort = 5432
$pgUser = 'postgres'
$pgDb = 'mi_db'
$ddlFile = 'C:\path\to\converted.sql'

# Ejecutar el DDL
psql -h $pgHost -p $pgPort -U $pgUser -d $pgDb -f $ddlFile
```

Si prefieres ejecutar fragmentos interactivos, abre `psql` y pega el SQL convertido. Para bases alojadas en Supabase puedes usar las credenciales del proyecto y el mismo comando `psql` (o el editor SQL en la consola de Supabase).

Capturas sugeridas:
- `data_modeler_export_ddl.png` — export DDL en Data Modeler.
- `psql_execute_ddl.png` — salida en PowerShell después de ejecutar `psql -f converted.sql` mostrando las sentencias ejecutadas y el resumen.
